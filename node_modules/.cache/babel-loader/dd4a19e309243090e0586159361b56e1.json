{"ast":null,"code":"/**\n * Last update: 2016/06/26\n * https://translate.google.com/translate/releases/twsfe_w_20160620_RC00/r/js/desktop_module_main.js\n *\n * Everything between 'BEGIN' and 'END' was copied from the url above.\n */\nvar got = require('got');\n\nvar Configstore = require('configstore');\n/* eslint-disable */\n// BEGIN\n\n\nfunction sM(a) {\n  var b;\n  if (null !== yr) b = yr;else {\n    b = wr(String.fromCharCode(84));\n    var c = wr(String.fromCharCode(75));\n    b = [b(), b()];\n    b[1] = c();\n    b = (yr = window[b.join(c())] || \"\") || \"\";\n  }\n  var d = wr(String.fromCharCode(116)),\n      c = wr(String.fromCharCode(107)),\n      d = [d(), d()];\n  d[1] = c();\n  c = \"&\" + d.join(\"\") + \"=\";\n  d = b.split(\".\");\n  b = Number(d[0]) || 0;\n\n  for (var e = [], f = 0, g = 0; g < a.length; g++) {\n    var l = a.charCodeAt(g);\n    128 > l ? e[f++] = l : (2048 > l ? e[f++] = l >> 6 | 192 : (55296 == (l & 64512) && g + 1 < a.length && 56320 == (a.charCodeAt(g + 1) & 64512) ? (l = 65536 + ((l & 1023) << 10) + (a.charCodeAt(++g) & 1023), e[f++] = l >> 18 | 240, e[f++] = l >> 12 & 63 | 128) : e[f++] = l >> 12 | 224, e[f++] = l >> 6 & 63 | 128), e[f++] = l & 63 | 128);\n  }\n\n  a = b;\n\n  for (f = 0; f < e.length; f++) a += e[f], a = xr(a, \"+-a^+6\");\n\n  a = xr(a, \"+-3^+b+-f\");\n  a ^= Number(d[1]) || 0;\n  0 > a && (a = (a & 2147483647) + 2147483648);\n  a %= 1E6;\n  return c + (a.toString() + \".\" + (a ^ b));\n}\n\nvar yr = null;\n\nvar wr = function (a) {\n  return function () {\n    return a;\n  };\n},\n    xr = function (a, b) {\n  for (var c = 0; c < b.length - 2; c += 3) {\n    var d = b.charAt(c + 2),\n        d = \"a\" <= d ? d.charCodeAt(0) - 87 : Number(d),\n        d = \"+\" == b.charAt(c + 1) ? a >>> d : a << d;\n    a = \"+\" == b.charAt(c) ? a + d & 4294967295 : a ^ d;\n  }\n\n  return a;\n}; // END\n\n/* eslint-enable */\n\n\nvar config = new Configstore('google-translate-api');\nvar window = {\n  TKK: config.get('TKK') || '0'\n};\n\nfunction updateTKK() {\n  return new Promise(function (resolve, reject) {\n    var now = Math.floor(Date.now() / 3600000);\n\n    if (Number(window.TKK.split('.')[0]) === now) {\n      resolve();\n    } else {\n      got('https://translate.google.com').then(function (res) {\n        var code = res.body.match(/TKK=(.*?)\\(\\)\\)'\\);/g);\n\n        if (code) {\n          eval(code[0]);\n          /* eslint-disable no-undef */\n\n          if (typeof TKK !== 'undefined') {\n            window.TKK = TKK;\n            config.set('TKK', TKK);\n          }\n          /* eslint-enable no-undef */\n\n        }\n        /**\n         * Note: If the regex or the eval fail, there is no need to worry. The server will accept\n         * relatively old seeds.\n         */\n\n\n        resolve();\n      }).catch(function (err) {\n        var e = new Error();\n        e.code = 'BAD_NETWORK';\n        e.message = err.message;\n        reject(e);\n      });\n    }\n  });\n}\n\nfunction get(text) {\n  return updateTKK().then(function () {\n    var tk = sM(text);\n    tk = tk.replace('&tk=', '');\n    return {\n      name: 'tk',\n      value: tk\n    };\n  }).catch(function (err) {\n    throw err;\n  });\n}\n\nmodule.exports.get = get;","map":null,"metadata":{},"sourceType":"script"}